{{
  config(
    alias = "z_placement_team_company_specific_analysis_for_specific_courses_and_specific_users"
    )
}}

WITH xpm_ccbp_plan_program_course_topic_unit_details AS (
  SELECT
    xpm_ccbp_plan_program_course_topic_unit_details.unit_id,
    xpm_ccbp_plan_program_course_topic_unit_details.course_id,
    xpm_ccbp_plan_program_course_topic_unit_details.course_title
  FROM {{ source('customer_success_prod', 'xpm_ccbp_plan_program_course_topic_unit_details') }} AS xpm_ccbp_plan_program_course_topic_unit_details
  WHERE (
    REPLACE(xpm_ccbp_plan_program_course_topic_unit_details.course_id,"-","") IN (
      "33a457452b2a4d60bc1683ca731081f3",
      "5d03f5a4a2854e528a5718f718c4859f",
      "a6454e48d0304d498920253198052232",
      "ae8d23eb85264fb9b8e43b320b12aa41",
      "e345dfa4f5ce406eb19a4ed720c54136"
    )
  ) 
),

xpm_ccbp_unit_durations AS (
  SELECT
    xpm_ccbp_unit_durations.unit_id,
    xpm_ccbp_unit_durations.duration_in_mins
  FROM {{ source('customer_success_prod', 'xpm_ccbp_unit_durations') }} AS xpm_ccbp_unit_durations
),

course_total_duration AS (
  SELECT 
    xpm_ccbp_plan_program_course_topic_unit_details.course_id,
    xpm_ccbp_plan_program_course_topic_unit_details.course_title,
    SUM(xpm_ccbp_unit_durations.duration_in_mins)/60 AS total_course_duration_in_hours
  FROM `xpm_ccbp_plan_program_course_topic_unit_details` AS xpm_ccbp_plan_program_course_topic_unit_details

  LEFT JOIN `xpm_ccbp_unit_durations` AS xpm_ccbp_unit_durations
  ON REPLACE(xpm_ccbp_plan_program_course_topic_unit_details.unit_id,"-","") = REPLACE(xpm_ccbp_unit_durations.unit_id,"-","")

  GROUP BY 
    xpm_ccbp_plan_program_course_topic_unit_details.course_id,
    xpm_ccbp_plan_program_course_topic_unit_details.course_title
),


user_wise_unit_wise_completion_percentage AS (
  SELECT 
    xpm_ccbp_users_resource_wise_completion_details.user_id,
    xpm_ccbp_users_resource_wise_completion_details.resource_id AS unit_id,
    xpm_ccbp_users_resource_wise_completion_details.resource_title AS unit_name,
    xpm_ccbp_users_resource_wise_completion_details.unit_type,
    xpm_ccbp_unit_durations.duration_in_mins,
    MAX(xpm_ccbp_users_resource_wise_completion_details.completion_percentage) AS unit_completion_percentage,
    xpm_ccbp_plan_program_course_topic_unit_details.course_id,
    xpm_ccbp_plan_program_course_topic_unit_details.course_title
  FROM {{ source('customer_success_prod', 'xpm_ccbp_users_resource_wise_completion_details') }} AS xpm_ccbp_users_resource_wise_completion_details

  INNER JOIN `xpm_ccbp_plan_program_course_topic_unit_details` AS xpm_ccbp_plan_program_course_topic_unit_details
  ON REPLACE(xpm_ccbp_users_resource_wise_completion_details.resource_id,"-","") = REPLACE(xpm_ccbp_plan_program_course_topic_unit_details.unit_id,"-","")

  LEFT JOIN `xpm_ccbp_unit_durations` AS xpm_ccbp_unit_durations
  ON REPLACE(xpm_ccbp_users_resource_wise_completion_details.resource_id,"-","") = REPLACE(xpm_ccbp_unit_durations.unit_id,"-","")

  WHERE ( 
    xpm_ccbp_users_resource_wise_completion_details.resource_type = "UNIT" 
    AND REPLACE(xpm_ccbp_users_resource_wise_completion_details.user_id,"-","") IN (
      "c579fe3d6d4a4eaeaf00a105c9a2060d",
      "39faef89d5944cf7a72ebab0c984fd1e",
      "a0e25cb32c704299b7e27e0868765055",
      "389b7acc9d2d42d487ad53dd1bcb16c3",
      "70f49500507c4d568fe2d0c6d7a1595c",
      "6724029990424503bcd5fa21f6b4966d",
      "747194997b2c4944ab6285399bc10322",
      "99384b20bb1c47ae9cf410110ca1332d",
      "81be038ef9b4484dbd9dea915ab493be",
      "029d926936654ab7bfb38c9128cc1596",
      "e651f66afa9f4099a4f4f2b9832f1949",
      "ba412b9acd4846378c36248ca3ed9226",
      "a1d53cfd28a64b6f8082704b9eeebdb3",
      "11eda31d56234340a04fecd6bf8e2403",
      "ea17c18b57034be5a41b18ced0574298",
      "7fe62f5ecd7240a78bae6ac0838c89b1",
      "ca91805dd9604d7bac7f15a321050d3c",
      "750f8d61c7c045d7a04530866fb2ef78",
      "2ba4e81ceb254ef3baddac00f19d34ae",
      "7ac6fe854af74687bff27e0135bb6349",
      "2d923ec7f4234ec0a97c9708309edbfa",
      "43e735eea6414b8a875f0f150dad1002",
      "b0268938384e43598a11c6df279c88df",
      "6589a75d3de54f2284570c708bbb193d",
      "645c0b0ef2db4aa891230d0cf36220e1",
      "49549ec7c5804a74b866bc7d154a7c6a",
      "5afa3de5957e4fb09c95050ff6df0984",
      "9abe896a4d5048fdb50ed33c680da4b5",
      "a8eb0de4edee4ef4b07c5841247564d0",
      "49c36041930e4f939d04cde680b3b459",
      "cb4f54b7707249f2b123a4f94ebf7838",
      "4130a10df1bb436aae320bccd9a9f1a5",
      "8fe3f1e6f2204726a4249ff97d2b7407",
      "7f77289b62d649fd8c1a68edbfff86b3",
      "3e35a353785142e982cf0c6daa0225a8",
      "8efe47da71194a63ae75359161a83826",
      "1555178c0dfa43bf8e3a322d28e5c3c6",
      "96cd271096254fa7b488b3220e2cffa8",
      "d9a2a01f869e42b5bff18bf7113131dc",
      "364cf649cf344edebfd234d7e37b7454",
      "63ab0214efda4413975c3bcb25f01335",
      "1a5709cab374492ea370842f1743a492",
      "6786111fbbb44d578cb6cbd6aa0fb491",
      "f4c7db64c86949899430f4acaa977929",
      "c9c8f3163d3c413cb4ec2ee1a5c43fc9",
      "aaf3fd15f20a4c3790cfcbcdf7332dcd",
      "21b939ecbea24d4bbecb35333a20850e",
      "c7f08134160847c0afc27b213a60e4c6",
      "531a6cfb54af4766958258fe1de08c02",
      "c93cdafab93b4051bad799bd0e6c84d8",
      "2004300953394e039f2cfec264abf520",
      "095b1f6fd3d94b3b97a2cf6e19286d0a",
      "d44bf1017a34459fa12c9635464428bd",
      "4bbfc2a7425e4e00a3898c818382257b",
      "b1c35a3398394f0498555d7cf0b3d8a0",
      "238c29d94106443e99428d6bb992140d",
      "981d33a0e8d646c99716c0ae1dbec703",
      "8bf21a5459d6419d9c6ab31f55c9518d",
      "0f5d8a9971b741f9855e470dbccd4ec8",
      "65cc35be39f84c468ee848031b385eb8",
      "b9ae0ad650d54bc9a43fdd515286d701",
      "6e2566190a87434995ef98fb1171e158",
      "79536d2f48404c908187297076ffed7b",
      "46f0c753b8354816b5d0d3a2adc383db",
      "888b45dd54d44a799cffa885465d0962",
      "ff394080234b4d71bba1f353803520e8",
      "df539204ac7f46859f6eb2886a70a0bf",
      "ba1567549de8462ca535739bd631f80a",
      "3dc9b94face449a3b4c9bcd3816a35a7",
      "dbc55d6dc69a4cb185ffa125cb1ac9d7",
      "4c6b7727cc454aeeaa37f96270d56884",
      "0df8ad869f4c44d78ea48c78cda8e146",
      "66b70ea87546456393bc40a14787e4dc",
      "b2ab83a7f2bb455d94f63f03365ce0ba",
      "8b82ee5d6d4c464baf6d486193dfa4d5",
      "eb97e2790fef4765818b3fa9f904474c",
      "dab35bb1508d4f9da750911f6bcbf013",
      "d7b8eaea2abd4cf2a7c2a06e3035cb7a",
      "52f41964900447398141bb976ba97986",
      "71a746acbc2b4de7a46e0ae272ef10ab",
      "0657d93fcc984f818f0ccc46190aaa89",
      "10d0c9238baa476e85c74cefa99f1d4f",
      "ff513577535b4fdca4a9b23946ddc43a",
      "716b906d6bee468597c32d68306c846d",
      "3a2a9fbea0fa4d58905bc403d7bebb04",
      "aaed85a045e3428ea9a0db9a688b8087",
      "9595f94ba24c43a0ba3aa09e7b2f3397",
      "88c2d3e0de7445548428eaafe8f4076c",
      "547147c6803f46fcae31782b81f45c2b",
      "4bfbf35e44ba46d9be9e4db8e968ba4f",
      "c08e8de5318c4ad0b5f043ed47825aae",
      "4862319ff3a74843a3629af8e6a2543a",
      "113c35d3bd0b42c8a7aa45ff242692ad",
      "37269f0673ab40e7aab34fa5c2dc3e24",
      "1002050208a7497ebd56450ff171d5d0",
      "9ec33352a8d94c42a2cf8c675f265a57",
      "74e5ad71c3804286b1fb584477155c7f",
      "8b18ce7c3aef469bb69720265ed457e4",
      "af36e537070f4289a5140b241351c8b9",
      "d1ba65f5f0bf4a1f825f162a673896a2",
      "2fae3104c637475e82359f439c6c734f",
      "0984edb92b7445479fd410a55c637493",
      "b7769b132650440fa426e2e479d93b70",
      "e46eb07ef15c4e9b87c36bfc4d2f40d7",
      "f5ab573f7f984fea816e8610029c8018",
      "f44c5f9dd86345bf82d9b051af437791",
      "8f2adefc237e416d97bb3732e7960418",
      "011e9eae3754401d926a40ba3457b6e7",
      "2f98076746de49d7a2924e3cc2ace056",
      "1594ca1c90154d1aa5163dba777f3318",
      "ac893372fdeb4a24969fd97e0e6ea7b5",
      "b8600898fd4f485abeb76839eef6bfa7",
      "abfb6d7ff1ce4ecd953fb024f3697441",
      "da07d34f9706423e9af09ac61413bdad",
      "2c4865b5c66244f9a65e2af716438902",
      "df25cf9715514195adcd05112fc40987",
      "e2fbe6e8291b464089bedea975324211",
      "73cb709d38dd42faae6551cbe8e3f230",
      "684c0fa57a90443aa6e47a5ca07773f5",
      "818f67c04ce64c0785abc357a662be7f",
      "18e955cb8ea0429daf4b97ea11af0581",
      "e996e34eab8145ad8a643efcc6d10108",
      "e6f1106982ec46b0bab5ad17fa6d155d",
      "ce59fb6dcf1c4ee9a14ec8f0abb516ca",
      "e2a5a1ee2664453cb869c8ea2479e45d",
      "eaef2f9580404467b038f8ceb2ce097c",
      "5a5ed24c81f84241be9d268bb25b4f33",
      "9c4bf811614c48fba8a34d30563b1320",
      "fe937641f9ad4c39a4fd0083fdb05898",
      "781b30d43e2244088e47403273c18feb",
      "cb200c966b6e4ba7acaab1427572976f",
      "6825a4188db64aea9e86193c8e96c894",
      "5c22b2f74af84dbca0a47fba49bfc265",
      "32e487909b974207948180a7608a4a95",
      "5f02fb7943194a688c3dd8dc850961d7",
      "eb23cb3c77b549a480c615fcb66f4b3d",
      "c925aec7e9304e5e88ddb2b41f1a53ea",
      "35e5cf026d6747918ea42d31d40e7337",
      "d002410402a9497ea40f5e44c022d3fe",
      "014dd4abd7734b93a455a77b1ef67e7e",
      "73096bbb26a846ac8c55fb750a9ff0aa",
      "dc67f2b40d9a4de3a5ae6ac644a9f3fc",
      "9d3be47c91364f69827e8cbd6d6ae278",
      "6c6441ca28d74ccab7f2788d39036c99",
      "fd9e3f20e6974117ae1ebfb22ae09e9f",
      "8e83c58ee95846399bbe437452629707",
      "3901f89752ec4ca9be308c6899d34c32",
      "52559a69b9924514bd7d0b5e38e7e269",
      "5038da1c7d87428c8b4b334477186861",
      "bc84b23f907c4063ac4333c887c207a2",
      "ccc74ee4c4af412bb3df161e505b9754",
      "328ca98bb5f643009dc792b6f2b41061",
      "a6e6f8e168d8460e96f7f1e759438ec0",
      "fb6e2c0e30344c44a2b14385af227169",
      "a7611112392c4d1a9e20e5590e5fb2c6",
      "a92eb2cbc6ab4e3fab221486cef4e041",
      "36fb246244be49b29b35d1431dc1a96e",
      "c39e6a6495174daf923071365a69af53",
      "0d816563b88140e8abf8414915434961",
      "90588192c5e6483dab916bdec867c1a1",
      "be235209944d481a8fab82504a12f45d",
      "bdd36fd3d0da47b99b09c90e555573db",
      "1e31de2b671344e090985ff4878ce2af",
      "3f5d1c6519a349d8aa159b7b83d0d57b",
      "78534867c6834321ab255e03bf3b9a1d",
      "a3eb0ae1b1ef4b7ab291601dd8148cb7",
      "6590ae372bc642a3af3ddd43682a7c0c",
      "db7587a013de44a2a66594f4c837352e",
      "d6378ea7f44e48cca8aac0888d18946b",
      "b3fc695a1c764495820cee0db6d7fa4a",
      "9d131e2fcb1244cba5aebbf6e5719696",
      "3374a2c9eadd439291efe3ed60dfae7a",
      "f9a1b2d350d149caa7604e9382609a3b",
      "f96d25bf23c84a38aa24ae2dbcdced25",
      "fd699deaf5f34da892c3e54376d510dc",
      "1bce2e1145564b0d92b7503480111311",
      "788bbdbc8e48466fb1c29bcfede43a67",
      "844b1082dffc400ba2471bc55c1bb973",
      "51caf54d778a4bed93a6f4ef8070df6e",
      "4984001847a84cb5b354496983e5e818",
      "b7d6053c169d40179e63174d1713c3e5",
      "743cec4153404ed6aa81da24c79bdaad",
      "10d61fbaf5f445f8a13a46eaa5edf5aa",
      "f8befb84ab4147bb8d63173f5b1ad3e7",
      "7777086c8df04a1e8c61a85b19732266",
      "d58110c086fd437b8c51bf50fbc71c1d",
      "a03f8067957349ae9947b58e123b5493",
      "ca2ea50bf36b49b0a80e11f8c8e57a3d",
      "1061ebea89c14954b342b56c8d23cfbc",
      "cecf839a27e44fbca20eae99be195fa2",
      "13110b13f95b403ab27a9e02ed76ca69",
      "888cfb1053234e9fbe7fb5470a6a5800",
      "5991fc72885c405191663972d5a9cfaa",
      "ae06974b12db4ce29dd10cd99164c845",
      "5391f80153164bb4a3a64a027c4a2ac1",
      "40064e7b34704b66b732fc0101d27728",
      "fa4693e68ca44030be6bb14fddb737ff",
      "80814634af2e4cd18e9c16e868679b12",
      "9e8bb4057e2e4d2c8a3820e3791aec5b",
      "7a9a14dfd1dc43c08b37447bd9c8c40a",
      "c89f5d2127e6436a86236007093b52a3",
      "20ba6611947642c8a9ea7405f3ffd6aa",
      "cdc6da4f20fc4f528b609fc0f3168060",
      "78bb187120234794ba36a664f1d7857f",
      "8c00f599340b4fd4896ca9ab3404c88f",
      "e3c66ed6d86a4cd9be1f0f691b55ce50",
      "2d9505b6e5da45609b199cb42c0c603f",
      "96084a66d10f44d8bd19784bf9fffb28",
      "66d08c509605466ab8a099c94eb308c5",
      "d5d928f4c26e4b4487fe7228a4807a14",
      "9f2891e1424a4747b20f0117ac16ed82",
      "2aa8638b94944c9da22d07443750c50e",
      "1b2bbdf4093f4f34afaf115389940bf1",
      "b79ca79bbc7545a5bb01739fe1f3171a",
      "63aa75b77b6f4f6fa5d6e56f5b02ecf0",
      "0155b49dd7904392b48c4d5739dab2ac",
      "893b261fc9554a77be5ed35e7723e74c",
      "ff794a8fed944ac8bdc7aae024123d0c",
      "87cba81991bc4dbe880ccf8d2c4995b3",
      "c81aefd0a6fa438ebce39422ea1e78e8",
      "06d8d105b43c43bbb813086ef56a4299",
      "afaf8043920d4558974a84d0226a30f1",
      "8635d9e834ff481cbeb5dd99803b7726",
      "e5d96d1a52454d529fe75010b8679da5",
      "665371d3f92c4783aa4ff8abfe9d1da6",
      "5a3bb89c2b7b42bdb505f2cb26a7bda0",
      "37f8bdeaa9b549ea8aaa9c33f47fb138",
      "7eca7dfd6fac43398f6b672cd436de05",
      "433d8bf756d640b3862d57c4758a0c58",
      "57e357bd1ddd44dabc94c6bedd691584",
      "b0d1be9e7fe44fc4a03b5eb0b22aaf8e",
      "61c9b596633d46a2b214397185862f42",
      "8e38cefadbae470b8bacff42ce75d885",
      "42852c8523f84bb789774b66ac16ef7e",
      "154e0950a7b443a08c9ef900b36ae46b",
      "bcd53fb92c0a48fba399010a86ff28c9",
      "c3d887be5dfe4254b60b43f0add63d7a",
      "1a5d2804e83b4b06850871c26a96a4cb",
      "8da6a3c482f649a5bdfa1fcbb9fad93b",
      "306f58e6330b4c9186d883d101991758",
      "0c68184994ae4bb1b15d47c223d805ab",
      "544aad28df31479797e79157336effa7",
      "d2661796aadb45c893b43d912490f52f",
      "b2c79db2ce3d4adb9c095b85efbf8612",
      "55e976c8398446418f019fe8a8e784f3",
      "8a4d4b9ba7c7425a9b6399dc807b80fc",
      "c420b645fb2a498ca9b4837aefea223e",
      "5f54c85797154ddb821f13df8e97d447",
      "c31a8d814626412882d5116d3bd7b9c5",
      "5f1277a729994bc18cc71cb571158eac",
      "b5eb09cca11a4e3195869af14b1b46a1",
      "2047c357864e4aea8f94977bb7f84b90",
      "6cfd2b429cab4b8b886f61d065f50402",
      "38fe35ad0ab645988e320ec71f61a82d",
      "eeec8b7194f34ca4aac14db2d2dd5b29",
      "03b41a3531844f7e9d453b73aee0cf3c",
      "3c29cebdc4c4403685c2af330ce6b8e2",
      "12b3fd9a2708450a8482d74d38840684",
      "4a678c8fa5b94d6d8d46b2248e1e3904",
      "4ab96a8ed44e4a258d433f488446f917",
      "9172e28c47b8456e902a111f8723d423",
      "c6c06dc9d60545ffbf8c3af3c7de522a",
      "ac8ab549c5094280b42e11513ece7400",
      "e2686ebe9db7457faea723b34288478b",
      "48a5cf92114c4a76b2286c501859028a",
      "f79fc20fc2a041f68fabc075c3cdb3aa",
      "879adb64e23a4b38a3d616582e735585",
      "3dcde3131cf5435a8106fed3e34c0ece",
      "66397e256601429491659d8dc3c78f5d",
      "e8b3931fe78a4532b1558f25bbc4ab43",
      "b8779f00a8e44d11a3b73cab3131df28",
      "6b4db9b3c0ad40c6a40c9eb7f9a74d8d",
      "7188f80e1550433eb78d358e62daab85",
      "55c21bceff99499ca5bf5b68ef9b6ccc",
      "81805d0245564d3b8487d4904ec809e4",
      "37dbf79d2c4b404e9dfb7b0aac95c4ea",
      "2e02ee6a646e47b1a2a08e48884a6f0b",
      "96b0d84306cb4e21aef9bade49d28aaa",
      "dcd8f3169ea342b1933711c5d6035c70",
      "1af80859b47d4392ba8233c1ed5a01fd",
      "dc2e2af1b1c747d2b0853c443ab5203e",
      "b28ef9eb5c0a49929d17eae8102608b7",
      "c56c4f365be54246b525f6ec097316a5",
      "17318329164d41fb8909a3c37cd8c61c",
      "3d3e82a3e3c34e2c8a6d7c218e8e2905",
      "c0841e6acbfd4657b16f0f23fdb2f066",
      "53cda9f2df164c84b1690106411d1b01",
      "45605ec3c293468381b6a5514223ec66",
      "947bb849d0e0481584a2bf3fa714f185",
      "296782fd15af4384a37538f4dda7b747",
      "21aaaa4153984d328c01e73c11e40e71",
      "8b9980eaaefb493dbb91d34782ed420e",
      "44d9261210dd4286b359c8133f4daa11",
      "7f2dcbbcf01944869b3a9797c6bed837",
      "0897e8bb9c1441279ccfb5e3d7628c9c",
      "c27945d6d3294e058484409c950c3984",
      "6b76d73622b44392b81f671260482c0c",
      "c4f4268ac76d4400a205d9768834e2fe",
      "3c8ccb9881104c488c87e4e18e233271",
      "c5435d0cd99f40d0aa079ba558558e78",
      "c4427f85ac7c45f694eeadd05151cefc",
      "8859c81a39ce4533982d47ed0ea61784",
      "ceeb9c70317344818116abc6741d8309",
      "335f3077210f45f7aa7000e0d5fb644a",
      "e3861b5b879b4d2b8d332b769dd8ef1d",
      "4c8b5c36bca1407886a89a08935b6096",
      "46e47c4260c94f0a9731e059bcb79e21",
      "475fcca3bf084c049e1cc878ec03dc98",
      "ac63bd29523f42bd9bf57a1a9b406b03",
      "acbc6cba20dd4677ab6be8d42e62339f",
      "1fbf3e5eb33248beadf7094fb7d5aa79",
      "adcd8cabb2c44a66b0a1f0181eaefbff",
      "b0f48c9cbe8a4d2790385c206098dbd0",
      "804506eda911425793dd0a4092eeff34",
      "2661c913493e43a9b8b36882d31fef25",
      "93df30c12bff4d24bba703b7f7ce2d33",
      "d1ab4380f06d4ce9b0a478645a28e6c1",
      "1eef306516d04f5e8a624826c269b287",
      "a4719ce306b645c591df313074e3b81b",
      "acf33471d6424cf6b65138cb3a8236c1",
      "265ddbd1a60641b2ac2e39732515f2f0",
      "8a242c6f02a246ae91e84a838648639a",
      "3784097874c7489d817dda3438f6c0fc",
      "5007db1cc48e40a39fde9ccc4576ac8b",
      "5a1e9f052e734520842c4118fb8a5ebc",
      "c301917bbae449fdacbe4e27fb90713a",
      "7c436cb60c2c4299aec4e39822749694",
      "e1c8fb29fbef47a399bfe6130bf55c18",
      "aa07e967629b462e954d74a6aa5fedad"
    )
  )

  GROUP BY 
    xpm_ccbp_users_resource_wise_completion_details.user_id,
    xpm_ccbp_users_resource_wise_completion_details.resource_id,
    xpm_ccbp_users_resource_wise_completion_details.resource_title,
    xpm_ccbp_users_resource_wise_completion_details.unit_type,
    xpm_ccbp_unit_durations.duration_in_mins, 
    xpm_ccbp_plan_program_course_topic_unit_details.course_id,
    xpm_ccbp_plan_program_course_topic_unit_details.course_title
),

user_wise_course_wise_time_spent AS (
  SELECT 
    user_wise_unit_wise_completion_percentage.user_id,
    user_wise_unit_wise_completion_percentage.course_id,
    user_wise_unit_wise_completion_percentage.course_title,
    SUM((user_wise_unit_wise_completion_percentage.unit_completion_percentage * user_wise_unit_wise_completion_percentage.duration_in_mins)/100)/60 AS total_course_completion_in_hours
  FROM `user_wise_unit_wise_completion_percentage` AS user_wise_unit_wise_completion_percentage

  GROUP BY 
    user_wise_unit_wise_completion_percentage.user_id,
    user_wise_unit_wise_completion_percentage.course_id,
    user_wise_unit_wise_completion_percentage.course_title 
)


SELECT 
  user_wise_course_wise_time_spent.user_id,
  user_wise_course_wise_time_spent.course_id,
  user_wise_course_wise_time_spent.course_title,
  ROUND(user_wise_course_wise_time_spent.total_course_completion_in_hours,2) AS total_course_completion_in_hours ,
  ROUND(course_total_duration.total_course_duration_in_hours,2) AS total_course_duration_in_hours,
  ROUND((user_wise_course_wise_time_spent.total_course_completion_in_hours/course_total_duration.total_course_duration_in_hours) * 100, 2) AS course_completion_percentage
FROM `user_wise_course_wise_time_spent` AS user_wise_course_wise_time_spent

LEFT JOIN `course_total_duration` AS course_total_duration
ON REPLACE(user_wise_course_wise_time_spent.course_id,"-","") = REPLACE(course_total_duration.course_id,"-","")